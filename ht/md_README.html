<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CSI-NN2: README</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">CSI-NN2<span id="projectnumber">&#160;2.1.x</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md_README.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">README </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >English | <a class="el" href="md_README_CN.html">简体中文</a></p>
<p >SHL(Structure of Heterogeneous Library, Chinese name: ShiHulan) is a high-performance Heterogeneous computing library provided by T-HEAD. The interface of SHL uses T-HEAD neural network library API for XuanTie CPU platform: CSI-NN2, and provides a series of optimized binary libraries.</p>
<p >Features for SHL:</p>
<ul>
<li>Reference implementation of c code version</li>
<li>Assembly optimization implementation for XuanTie CPU</li>
<li>Supports symmetric quantization and asymmetric quantization</li>
<li>Support 8bit, 16bit, and f16 data types</li>
<li>compaatible with NCHW and NHWC formates</li>
<li>Use <a href="https://www.yuque.com/za4k4z/kvkcoh">HHB</a> to automatically call API</li>
<li>Covers different architectures, such as CPU and NPU</li>
<li>Reference heterogeneous schedule implementation</li>
</ul>
<p >In principle, SHL only provides the reference implementation of XuanTie CPU platform, and the optimization of each NPU target platform is completed by the vendor of the specific platform.</p>
<h1><a class="anchor" id="autotoc_md0"></a>
Use SHL</h1>
<ul>
<li><a href="https://csi-nn2.opensource.alibaba.com/">SHL</a></li>
<li><a href="https://www.yuque.com/za4k4z/kkzsw9">SHL API</a></li>
<li><a href="https://www.yuque.com/za4k4z/kvkcoh">SHL deployment tools</a></li>
</ul>
<h1><a class="anchor" id="autotoc_md1"></a>
Installation</h1>
<h2><a class="anchor" id="autotoc_md2"></a>
Official Python packages</h2>
<p >SHL released packages are published in PyPi, can install with hhb.</p>
<div class="fragment"><div class="line">pip3 install hhb</div>
</div><!-- fragment --><p >binary libary is at /usr/local/lib/python3.6/dist-packages/tvm/install_nn2/</p>
<h2><a class="anchor" id="autotoc_md3"></a>
Build SHL from Source</h2>
<p >Here is one example to build C906 library.</p>
<p >We need to install T-HEAD RISC-V GCC 2.6, which can get from T-HEAD OCC, download, decompress, and set path environment.</p>
<div class="fragment"><div class="line">wget https://occ-oss-prod.oss-cn-hangzhou.aliyuncs.com/resource//1663142514282/Xuantie-900-gcc-linux-5.10.4-glibc-x86_64-V2.6.1-20220906.tar.gz</div>
<div class="line">tar xf Xuantie-900-gcc-linux-5.10.4-glibc-x86_64-V2.6.1-20220906.tar.gz</div>
<div class="line">export PATH=${PWD}/Xuantie-900-gcc-linux-5.10.4-glibc-x86_64-V2.6.1/bin:$PATH</div>
</div><!-- fragment --><p >Download source code</p>
<div class="fragment"><div class="line">git clone https://github.com/T-head-Semi/csi-nn2.git</div>
</div><!-- fragment --><p >compile c906</p>
<div class="fragment"><div class="line">cd csi-nn2</div>
<div class="line">make nn2_c906</div>
</div><!-- fragment --><p >install c906</p>
<div class="fragment"><div class="line">make install_nn2</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md4"></a>
Quick Start Example</h1>
<p >Here is one example for XuanTie C906 to run mobilenetv1. It shows how to call SHL API to inference the whole model.</p>
<p >compile command:</p>
<div class="fragment"><div class="line">cd example</div>
<div class="line">make c906_m1_f16</div>
</div><!-- fragment --><p >c906_mobilenetv1_f16.elf will be generated after completion. After copying it to the development board with C906 CPU [such as D1], execute:</p>
<div class="fragment"><div class="line">./c906_mobilenetv1_f16.elf</div>
</div><!-- fragment --><p >NOTE: Original mobilenetv1's every conv2d has one BN(batch norm), but the example assumes BN had been fused into conv2d。About how to use deployment tools to fuse BN, and emit right weight float16 value, can reference <a href="https://www.yuque.com/za4k4z/kvkcoh">HHB</a>.</p>
<h1><a class="anchor" id="autotoc_md5"></a>
Resources</h1>
<ul>
<li><a href="https://xrvm.com/">T-HEAD Open Chip Community</a></li>
<li><a href="https://github.com/mlcommons/tiny_results_v0.7/tree/main/open/Alibaba">Use SHL to run MLPerf tiny</a></li>
</ul>
<h2><a class="anchor" id="autotoc_md6"></a>
Acknowledgement</h2>
<p >SHL refers to the following projects:</p>
<ul>
<li><a href="https://github.com/BVLC/caffe">Caffe</a></li>
<li><a href="https://github.com/tensorflow/tensorflow">Tensorflow</a></li>
<li><a href="https://github.com/Tencent/ncnn">ncnn</a></li>
<li><a href="https://github.com/alibaba/MNN">MNN</a></li>
<li><a href="https://github.com/OAID/Tengine">Tengine</a></li>
<li><a href="https://github.com/ARM-software/CMSIS_5">CMSIS_5</a></li>
<li><a href="https://github.com/onnx/onnx">ONNX</a></li>
<li><a href="https://github.com/google/XNNPACK">XNNPACK</a> </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5 </li>
  </ul>
</div>
</body>
</html>
